{"remainingRequest":"/Users/antoniogarciaabasolo/Desktop/apps/towary/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/antoniogarciaabasolo/Desktop/apps/towary/src/components/BookList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/antoniogarciaabasolo/Desktop/apps/towary/src/components/BookList.vue","mtime":1571993654934},{"path":"/Users/antoniogarciaabasolo/Desktop/apps/towary/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/antoniogarciaabasolo/Desktop/apps/towary/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgKiBhcyBBcGkgZnJvbSAnLi4vYXBpLmpzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQm9va0xpc3QnLAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgYm9va3M6IFtdLAogICAgICBmaWx0ZXJlZEJvb2tzOiBbXSwKICAgICAgYm9va3NQZXJQYWdlOiA1LAogICAgICBwYWdlOiAwLAogICAgICB1c2VyTGlrZWRCb29rczogW10sCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICB9CiAgfSwKICBwcm9wczogewogICAgdXNlcjogeyB0eXBlOiBPYmplY3QgfSwKICAgIHVzZXJGYXZCb29rczogeyB0eXBlOiBBcnJheSB9LAogICAgc2VhcmNoSW5wdXQ6IHsgdHlwZTogU3RyaW5nIH0sCiAgfSwKICBjb21wdXRlZDogewogICAgcGFnaW5hdGVkQm9va3M6IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5ib29rcykgewogICAgICAgIGNvbnN0IHN0YXJ0ID0gKHRoaXMucGFnZSAqIHRoaXMuYm9va3NQZXJQYWdlKTsKICAgICAgICB0aGlzLnBhZ2UgPiAwID8gc3RhcnQgLSAxIDogJyc7CiAgICAgICAgY29uc3QgZW5kID0gKHRoaXMucGFnZSAqIHRoaXMuYm9va3NQZXJQYWdlICsgdGhpcy5ib29rc1BlclBhZ2UpOwogICAgICAgIHJldHVybiB0aGlzLmJvb2tzLnNsaWNlKHN0YXJ0LCBlbmQpOwogICAgICB9CiAgICB9LAogICAgc2hvd2luZ0Jvb2tzOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuc2VhcmNoSW5wdXQubGVuZ3RoID4gMCA/IHRoaXMuZmlsdGVyZWRCb29rcyA6IHRoaXMucGFnaW5hdGVkQm9va3M7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgc2VhcmNoSW5wdXQ6IGZ1bmN0aW9uKHNlYXJjaElucHV0KSB7CiAgICAgIHRoaXMuJG5leHRUaWNrKF8gPT4gewogICAgICAgIGNvbnN0IGJvb2tzTWF0Y2hlZCA9IG5ldyBTZXQoKTsKICAgICAgICBmb3IgKGxldCBib29rIG9mIHRoaXMuYm9va3MpIHsKICAgICAgICAgIGlmIChib29rLnRpdGxlLnRvTG93ZXJDYXNlKCkubWF0Y2goc2VhcmNoSW5wdXQudG9Mb3dlckNhc2UoKSkpwqB7CiAgICAgICAgICAgIGJvb2tzTWF0Y2hlZC5hZGQoYm9vayk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYm9vay5zeW5vcHNpcy50b0xvd2VyQ2FzZSgpLm1hdGNoKHNlYXJjaElucHV0LnRvTG93ZXJDYXNlKCkpKSB7CiAgICAgICAgICAgIGJvb2tzTWF0Y2hlZC5hZGQoYm9vayk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgdGhpcy5maWx0ZXJlZEJvb2tzID0gWy4uLmJvb2tzTWF0Y2hlZF07CiAgICAgIH0pOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMuYm9va3MubGVuZ3RoID4gMCkgcmV0dXJuOwogICAgdGhpcy4kbmV4dFRpY2soYXN5bmMgZnVuY3Rpb24oKSB7CiAgICAgIGNvbnN0IHJlcSA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYm9va3MnKTsKICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IHJlcS5qc29uKCk7CiAgICAgIHRoaXMuYm9va3MgPSByZXNwLmJvb2tzOwogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgIH0pOwogIH0sCiAgbWV0aG9kczogewogICAgb25DbGlja1Vwdm90ZTogYXN5bmMgZnVuY3Rpb24oYm9vaywgZXZ0KSB7CiAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgY29uc3QgdGFyZ2V0ID0gZXZ0LmN1cnJlbnRUYXJnZXQ7CiAgICAgIGNvbnN0IG1hdGNoZWQgPSB0aGlzLnVzZXJGYXZCb29rcy5maW5kKGIgPT4gYi5zbHVnID09PSBib29rLnNsdWcpOwogICAgICB0aGlzLiRlbWl0KCdhZGQtdG8tZmF2JywgYm9vayk7CiAgICAgIGlmIChCb29sZWFuKG1hdGNoZWQpKSB7CiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKF8gPT4gdGFyZ2V0LnJlbW92ZUF0dHJpYnV0ZSgnbGlrZWQnLCAidHJ1ZSIpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoXyA9PiB0YXJnZXQuc2V0QXR0cmlidXRlKCdsaWtlZCcsICJ0cnVlIikpOwogICAgICB9CiAgICB9LAogICAgY29tcHV0ZVVzZXJMaWtlQm9vazogZnVuY3Rpb24oYm9vaykgewogICAgIHJldHVybiBCb29sZWFuKHRoaXMudXNlckZhdkJvb2tzLmZpbmQoYiA9PiBiLnNsdWcgPT09IGJvb2suc2x1ZykpOwogICAgfSwKICAgIGNvbXB1dGVCb29rUG9zKHNsdWcpIHsKICAgICAgcmV0dXJuIHRoaXMuYm9va3MuZmluZEluZGV4KGIgPT4gYi5zbHVnID09PSBzbHVnKSArIDE7CiAgICB9LAogIH0KfQo="},{"version":3,"sources":["BookList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BookList.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <div\n        @click=\"$emit('open-book-overlay', book)\"\n        @keyup.enter=\"$emit('open-book-overlay', book)\"\n        class=\"book\"\n        v-for=\"(book, index) in showingBooks\"\n        :key=\"index\"\n        tabindex=\"0\">\n      <div class=\"book-info\">\n        <div class=\"book-header-info\">\n          <div class=\"book-position\">{{ computeBookPos(book.slug) }}. </div>\n          <div class=\"book-title\">{{ book.title }}</div>\n          <div class=\"book-rating\"> {{ book.rating }}/10 </div>\n        </div>\n        <div class=\"book-synopsis\">{{ book.synopsis }}</div>\n        <div class=\"book-footer\">\n          <div class=\"book-author\">{{ book.author }}</div>\n          <button :key=\"book.slug\" :liked=\"computeUserLikeBook(book, userLikedBooks)\" @click=\"onClickUpvote(book, $event)\" class=\"book-upvote-btn\">\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"><g><path d=\"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-1.91l-.01-.01L23 10z\" class=\"style-scope yt-icon\"></path></g></svg>\n            <div class=\"book-upvotes-number\">{{ book.upvotes }}</div>\n          </button>\n        </div>\n      </div>\n      <div class=\"book-cover-container\">\n        <img :src=\"book.cover\" class=\"book-cover\"/>\n      </div>\n    </div>\n    <div v-show=\"!this.searchInput.length > 0\" class=\"navigation\">\n      <div class=\"nav-btn prev\" v-show=\"page > 0\" @click=\"page -= 1\">Previous page</div>\n      <div class=\"nav-btn forward\" v-show=\"books.length > booksPerPage * (page + 1)\" @click=\"page += 1\">Next page</div>\n    </div>\n    <div class=\"spinner\" v-if=\"loading\"></div>\n  </div>\n</template>\n\n<script>\n\n  import * as Api from '../api.js';\n\n  export default {\n    name: 'BookList',\n    data: function() {\n      return {\n        books: [],\n        filteredBooks: [],\n        booksPerPage: 5,\n        page: 0,\n        userLikedBooks: [],\n        loading: true,\n      }\n    },\n    props: {\n      user: { type: Object },\n      userFavBooks: { type: Array },\n      searchInput: { type: String },\n    },\n    computed: {\n      paginatedBooks: function() {\n        if (this.books) {\n          const start = (this.page * this.booksPerPage);\n          this.page > 0 ? start - 1 : '';\n          const end = (this.page * this.booksPerPage + this.booksPerPage);\n          return this.books.slice(start, end);\n        }\n      },\n      showingBooks: function() {\n        return this.searchInput.length > 0 ? this.filteredBooks : this.paginatedBooks;\n      }\n    },\n    watch: {\n      searchInput: function(searchInput) {\n        this.$nextTick(_ => {\n          const booksMatched = new Set();\n          for (let book of this.books) {\n            if (book.title.toLowerCase().match(searchInput.toLowerCase()))Â {\n              booksMatched.add(book);\n            }\n            if (book.synopsis.toLowerCase().match(searchInput.toLowerCase())) {\n              booksMatched.add(book);\n            }\n          }\n         this.filteredBooks = [...booksMatched];\n        });\n      }\n    },\n    mounted: function () {\n      if (this.books.length > 0) return;\n      this.$nextTick(async function() {\n        const req = await fetch('http://localhost:3000/books');\n        const resp = await req.json();\n        this.books = resp.books;\n        this.loading = false;\n      });\n    },\n    methods: {\n      onClickUpvote: async function(book, evt) {\n        evt.stopPropagation();\n        const target = evt.currentTarget;\n        const matched = this.userFavBooks.find(b => b.slug === book.slug);\n        this.$emit('add-to-fav', book);\n        if (Boolean(matched)) {\n          requestAnimationFrame(_ => target.removeAttribute('liked', \"true\"));\n        } else {\n          requestAnimationFrame(_ => target.setAttribute('liked', \"true\"));\n        }\n      },\n      computeUserLikeBook: function(book) {\n       return Boolean(this.userFavBooks.find(b => b.slug === book.slug));\n      },\n      computeBookPos(slug) {\n        return this.books.findIndex(b => b.slug === slug) + 1;\n      },\n    }\n  }\n</script>\n\n<style scoped>\n\n  .navigation {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin: 10px;\n  }\n\n  .nav-btn {\n    color: #174f82;\n    border: 1px solid #174f82;\n    padding: 4px 12px;\n    border-radius: 3px;\n    cursor: pointer;\n  }\n\n  .forward {\n    margin-left: auto;\n  }\n\n  .book-list {\n    box-sizing: border-box;\n    flex: 1 1 0%;\n    min-height: 100%;\n    overflow: auto;\n    padding: 5px 10px;\n  }\n\n  .book {\n    align-items: center;\n    background: rgb(255, 255, 255);\n    border-radius: 8px;\n    box-shadow: rgba(0, 0, 0, 0.04) 0px 0px 1px 0px;\n    box-sizing: border-box;\n    padding: 10px;\n    display: grid;\n    grid-template-columns: 70% 30%;\n    cursor: pointer;\n    margin: 0 10px 6px 10px;\n  }\n\n  .book:focus {\n    outline-color: #039BE5;\n  }\n\n  .book-cover {\n    width: 20vw;\n    max-height: 170px;\n    max-width: 113px;\n    border-radius: 8px;\n    box-shadow: 0 0 1px 0 rgba(0,0,0,0.16);\n  }\n\n  .book-author {\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n\n  .book-info {\n    padding-left: 10px;\n  }\n\n  .book-title {\n    text-overflow: ellipsis;\n    overflow: hidden;\n    max-width: 90%;\n    white-space: nowrap;\n    padding: 0 5px;\n    flex: 1;\n  }\n\n  .separator {\n    margin: 0 5px;\n  }\n\n  .book-footer {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n  }\n\n  .book-synopsis {\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 3;\n    overflow: hidden;\n    margin: 20px 0;\n    font-size: 14px;\n  }\n\n  .book-title, .book-position {\n    color: #184f82;\n    font-weight: 500;\n    font-size: 20px;\n  }\n\n  .book-header-info {\n    display: flex;\n    align-items: center;\n  }\n\n  .book-upvote-btn {\n    color: #636363;\n    fill: #909090;\n    display: flex;\n    align-items: center;\n    background: none;\n    border: none;\n    cursor: pointer;\n    width: 70px;\n    height: 24px;\n    padding: 0;\n    justify-content: center;\n  }\n\n  .book-upvote-btn:focus {\n    outline-color: #039BE5;\n  }\n\n  .book-upvotes-number {\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n    font-weight: 500;\n    margin-left: 5px;\n    font-size: 14px;\n  }\n\n  .book-cover-container {\n    display: flex;\n    justify-content: center;\n  }\n\n  [liked] {\n    transition: all .1s ease;\n    background: #BF360C;\n    fill: #ffffff;\n    color: #ffffff;\n    border-radius: 4px;\n  }\n\n  .spinner {\n    width: 40px;\n    height: 40px;\n    margin: 100px auto;\n    background-color: #333;\n\n    border-radius: 100%;  \n    -webkit-animation: sk-scaleout 1.0s infinite ease-in-out;\n    animation: sk-scaleout 1.0s infinite ease-in-out;\n  }\n\n  @-webkit-keyframes sk-scaleout {\n    0% { -webkit-transform: scale(0) }\n    100% {\n      -webkit-transform: scale(1.0);\n      opacity: 0;\n    }\n  }\n\n  @keyframes sk-scaleout {\n    0% { \n      -webkit-transform: scale(0);\n      transform: scale(0);\n    } 100% {\n      -webkit-transform: scale(1.0);\n      transform: scale(1.0);\n      opacity: 0;\n    }\n  }\n \n</style>\n"]}]}